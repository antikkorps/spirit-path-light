---
// Theme customizer with DaisyUI themes
---

<button
	id="theme-customizer-btn"
	class="fixed bottom-20 right-4 sm:right-6 z-40 btn btn-circle btn-lg bg-gradient-to-br from-primary to-secondary border-none shadow-lg hover:shadow-xl"
	aria-label="Personnaliser le th√®me"
	title="Choisir un th√®me"
>
	<svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
	</svg>
</button>

<!-- Customizer Panel -->
<div
	id="theme-customizer-panel"
	class="fixed inset-y-0 right-0 z-50 w-full sm:w-96 bg-base-100 shadow-2xl transform translate-x-full transition-transform duration-300 overflow-y-auto"
>
	<div class="p-6">
		<!-- Header -->
		<div class="flex items-center justify-between mb-6">
			<h3 class="text-2xl font-bold">Th√®mes</h3>
			<button
				id="theme-customizer-close"
				class="btn btn-ghost btn-circle btn-sm"
				aria-label="Fermer"
			>
				<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
				</svg>
			</button>
		</div>

		<!-- Theme Categories -->
		<div class="space-y-6">
			<!-- Light Themes -->
			<div>
				<h4 class="text-sm font-semibold opacity-70 mb-3">‚òÄÔ∏è Th√®mes Clairs</h4>
				<div class="grid grid-cols-1 gap-2">
					<button class="theme-option" data-theme="light">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#4a6b4e]"></div>
								<div class="w-4 h-8 rounded bg-[#8a7f66]"></div>
								<div class="w-4 h-8 rounded bg-[#d4a59a]"></div>
							</div>
							<span class="font-medium">Spirit Path (clair)</span>
						</div>
					</button>

					<button class="theme-option" data-theme="cupcake">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#65c3c8]"></div>
								<div class="w-4 h-8 rounded bg-[#ef9fbc]"></div>
								<div class="w-4 h-8 rounded bg-[#eeaf3a]"></div>
							</div>
							<span class="font-medium">Cupcake</span>
						</div>
					</button>

					<button class="theme-option" data-theme="emerald">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#66cc8a]"></div>
								<div class="w-4 h-8 rounded bg-[#377cfb]"></div>
								<div class="w-4 h-8 rounded bg-[#f68067]"></div>
							</div>
							<span class="font-medium">Emerald</span>
						</div>
					</button>

					<button class="theme-option" data-theme="pastel">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#d1c1d7]"></div>
								<div class="w-4 h-8 rounded bg-[#f6cbd1]"></div>
								<div class="w-4 h-8 rounded bg-[#b4e9d6]"></div>
							</div>
							<span class="font-medium">Pastel</span>
						</div>
					</button>

					<button class="theme-option" data-theme="fantasy">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#6e0b75]"></div>
								<div class="w-4 h-8 rounded bg-[#c026d3]"></div>
								<div class="w-4 h-8 rounded bg-[#e879f9]"></div>
							</div>
							<span class="font-medium">Fantasy</span>
						</div>
					</button>

					<button class="theme-option" data-theme="lofi">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#0d0d0d]"></div>
								<div class="w-4 h-8 rounded bg-[#1a1a1a]"></div>
								<div class="w-4 h-8 rounded bg-[#808080]"></div>
							</div>
							<span class="font-medium">Lo-Fi</span>
						</div>
					</button>

					<button class="theme-option" data-theme="winter">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#047AFF]"></div>
								<div class="w-4 h-8 rounded bg-[#463AA2]"></div>
								<div class="w-4 h-8 rounded bg-[#C148AC]"></div>
							</div>
							<span class="font-medium">Winter</span>
						</div>
					</button>
				</div>
			</div>

			<!-- Dark Themes -->
			<div>
				<h4 class="text-sm font-semibold opacity-70 mb-3">üåô Th√®mes Sombres</h4>
				<div class="grid grid-cols-1 gap-2">
					<button class="theme-option" data-theme="dark">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#5a8a5e]"></div>
								<div class="w-4 h-8 rounded bg-[#b8a889]"></div>
								<div class="w-4 h-8 rounded bg-[#e4b5aa]"></div>
							</div>
							<span class="font-medium">Spirit Path (sombre)</span>
						</div>
					</button>

					<button class="theme-option" data-theme="forest">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#1eb854]"></div>
								<div class="w-4 h-8 rounded bg-[#1fd65f]"></div>
								<div class="w-4 h-8 rounded bg-[#d99330]"></div>
							</div>
							<span class="font-medium">Forest</span>
						</div>
					</button>

					<button class="theme-option" data-theme="business">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#1c4e80]"></div>
								<div class="w-4 h-8 rounded bg-[#7c909a]"></div>
								<div class="w-4 h-8 rounded bg-[#ea6947]"></div>
							</div>
							<span class="font-medium">Business</span>
						</div>
					</button>

					<button class="theme-option" data-theme="night">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#38bdf8]"></div>
								<div class="w-4 h-8 rounded bg-[#818cf8]"></div>
								<div class="w-4 h-8 rounded bg-[#f471b5]"></div>
							</div>
							<span class="font-medium">Night</span>
						</div>
					</button>

					<button class="theme-option" data-theme="coffee">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#DB924B]"></div>
								<div class="w-4 h-8 rounded bg-[#263E3F]"></div>
								<div class="w-4 h-8 rounded bg-[#10576D]"></div>
							</div>
							<span class="font-medium">Coffee</span>
						</div>
					</button>
				</div>
			</div>

			<!-- Seasonal Themes -->
			<div>
				<h4 class="text-sm font-semibold opacity-70 mb-3">üçÇ Th√®mes Saisonniers</h4>
				<div class="grid grid-cols-1 gap-2">
					<button class="theme-option" data-theme="autumn">
						<div class="flex items-center gap-3">
							<div class="flex gap-1">
								<div class="w-4 h-8 rounded bg-[#8C0327]"></div>
								<div class="w-4 h-8 rounded bg-[#D85251]"></div>
								<div class="w-4 h-8 rounded bg-[#7C9D96]"></div>
							</div>
							<span class="font-medium">Autumn</span>
						</div>
					</button>
				</div>
			</div>
		</div>

		<!-- Info -->
		<div class="mt-6 p-4 bg-base-200 rounded-lg">
			<p class="text-xs opacity-70">
				üí° Les th√®mes sont optimis√©s pour la lisibilit√© avec des contrastes harmonieux.
				Changez avec le bouton ‚òÄÔ∏è/üåô dans le menu.
			</p>
		</div>
	</div>
</div>

<!-- Backdrop -->
<div
	id="theme-customizer-backdrop"
	class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40"
></div>

<style is:global>
	.theme-option {
		width: 100%;
		padding: 0.75rem;
		border-radius: 0.5rem;
		border: 2px solid;
		text-align: left;
		transition: all 0.3s;
	}

	[data-theme="light"] .theme-option {
		border-color: oklch(var(--bc) / 0.2);
	}

	[data-theme="dark"] .theme-option {
		border-color: oklch(var(--bc) / 0.2);
	}

	.theme-option:hover {
		border-color: oklch(var(--p));
		transform: scale(1.02);
	}

	.theme-option:active {
		transform: scale(0.98);
	}

	.theme-option.active {
		border-color: oklch(var(--p));
		background-color: oklch(var(--p) / 0.1);
	}
</style>

<script>
	const THEME_KEY = 'spirit-path-theme';

	function getTheme(): string {
		return localStorage.getItem(THEME_KEY) || 'light';
	}

	function setTheme(theme: string) {
		document.documentElement.setAttribute('data-theme', theme);
		localStorage.setItem(THEME_KEY, theme);

		// Update active state
		document.querySelectorAll('.theme-option').forEach(btn => {
			if (btn.getAttribute('data-theme') === theme) {
				btn.classList.add('active');
			} else {
				btn.classList.remove('active');
			}
		});

		// Dispatch event for ThemeSwitch
		window.dispatchEvent(new CustomEvent('theme-changed', { detail: { theme } }));
	}

	document.addEventListener('DOMContentLoaded', () => {
		const customizerBtn = document.getElementById('theme-customizer-btn');
		const customizerPanel = document.getElementById('theme-customizer-panel');
		const customizerClose = document.getElementById('theme-customizer-close');
		const customizerBackdrop = document.getElementById('theme-customizer-backdrop');

		// Open/Close panel
		const openPanel = () => {
			customizerPanel?.classList.remove('translate-x-full');
			customizerBackdrop?.classList.remove('hidden');
		};

		const closePanel = () => {
			customizerPanel?.classList.add('translate-x-full');
			customizerBackdrop?.classList.add('hidden');
		};

		customizerBtn?.addEventListener('click', openPanel);
		customizerClose?.addEventListener('click', closePanel);
		customizerBackdrop?.addEventListener('click', closePanel);

		// Theme selection
		document.querySelectorAll('.theme-option').forEach((btn) => {
			btn.addEventListener('click', () => {
				const theme = btn.getAttribute('data-theme');
				if (theme) {
					setTheme(theme);
				}
			});
		});

		// Initialize active theme
		const currentTheme = getTheme();
		setTheme(currentTheme);
	});
</script>
